

# ===== Fichier : /Users/martintarot/Documents/Informatique/TrueLink/README.md =====

# TrueLink

Petit projet entre amis pour tester **FastAPI** et **SQLModel**.

---

## üîß Fonctionnement global

Le projet est d√©coup√© en deux parties :

- **Backend** : FastAPI + SQLModel (API, authentification, base SQLite)  
- **Frontend** : HTML / JS statique servi directement par FastAPI  

L‚ÄôAPI permet :  
- d‚Äôenregistrer un utilisateur,  
- de se connecter,  
- et de g√©n√©rer un **token JWT** pour l‚Äôauthentification.  

---

## üß∞ Script utilitaire : `merge_py_files.py`

Ce script fusionne **tous les fichiers texte du projet** (`.py`, `.html`, `.js`, `.md`, etc.)  
dans un seul fichier nomm√© **`all_text_files_merged.txt`**.

üí° *Pratique pour relire le projet complet ou le partager facilement.*

### Utilisation
```bash
python merge_py_files.py
```

---

## üëë Page admin cach√©e

Accessible via :  
```
/admin
```

Mot de passe par d√©faut : `admin`  
‚ö†Ô∏è *√Ä d√©placer dans un `.env` pour un usage en production.*

Cette page affiche une **table HTML des utilisateurs inscrits**,  
directement tir√©e de la base de donn√©es SQLite.

---

## ‚öôÔ∏è Lancer le projet

```bash
cd TL_backend
pip install -r requirements.txt
uvicorn app.main:app --reload
```

Frontend accessible sur :  
```
http://127.0.0.1:8000
```

---

> Projet fun, l√©ger, et pr√™t √† √™tre bricol√© üîß


# ===== Fichier : /Users/martintarot/Documents/Informatique/TrueLink/TL_backend/app/__init__.py =====



# ===== Fichier : /Users/martintarot/Documents/Informatique/TrueLink/TL_backend/app/core/__init__.py =====



# ===== Fichier : /Users/martintarot/Documents/Informatique/TrueLink/TL_backend/app/core/config.py =====



# ===== Fichier : /Users/martintarot/Documents/Informatique/TrueLink/TL_backend/app/core/security.py =====

from passlib.context import CryptContext
from datetime import datetime, timedelta
from jose import JWTError, jwt
from typing import Optional

pwd_context = CryptContext(schemes=["bcrypt"], deprecated="auto")

def hash_password(password: str) -> str:
    # S'assurer que c'est bien une string simple
    print(password)
    password = str(password)
    
    return pwd_context.hash(password)

def verify_password(plain_password: str, hashed_password: str) -> bool:
    return pwd_context.verify(plain_password, hashed_password)


SECRET_KEY = "super_secret_key_dev"  # √† mettre dans .env en prod
ALGORITHM = "HS256"
ACCESS_TOKEN_EXPIRE_MINUTES = 60

def create_access_token(data: dict):
    to_encode = data.copy()
    expire = datetime.utcnow() + timedelta(minutes=ACCESS_TOKEN_EXPIRE_MINUTES)
    to_encode.update({"exp": expire})
    encoded_jwt = jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)
    return encoded_jwt

def verify_token(token: str) -> Optional[int]:
    """V√©rifie le token JWT et retourne l'user_id"""
    try:
        payload = jwt.decode(token, SECRET_KEY, algorithms=[ALGORITHM])
        user_id = payload.get("sub")
        if user_id is None:
            return None
        return int(user_id)
    except JWTError:
        return None

# ===== Fichier : /Users/martintarot/Documents/Informatique/TrueLink/TL_backend/app/database.py =====

from sqlmodel import SQLModel, create_engine
from .models import User  # <- important !$

# URL de la base de donn√©es SQLite (fichier local)
DATABASE_URL = "sqlite:///./dating_app.db"

# Cr√©ation du moteur SQLAlchemy/SQLModel
engine = create_engine(DATABASE_URL, echo=True)  # echo=True = logs SQL visibles

# Fonction utilitaire pour cr√©er toutes les tables
def init_db():
    SQLModel.metadata.create_all(engine)


# ===== Fichier : /Users/martintarot/Documents/Informatique/TrueLink/TL_backend/app/main.py =====

from fastapi import FastAPI
from fastapi.staticfiles import StaticFiles
from fastapi.responses import FileResponse
from contextlib import asynccontextmanager
from .database import init_db
from .routes import users, auth, profile
import os
from fastapi import Request, HTTPException, Form
from sqlmodel import Session, select
from fastapi.responses import HTMLResponse
from .models import User
from .database import engine

@asynccontextmanager
async def lifespan(app: FastAPI):
    init_db()
    print("‚úÖ Database initialized.")
    yield
    print("üõë Shutting down app...")

app = FastAPI(lifespan=lifespan)

# Inclusion des routes
app.include_router(users.router)
app.include_router(auth.router)
app.include_router(profile.router)  # ‚Üê Nouvelle route

# Servir les fichiers statiques
frontend_path = os.path.join(os.path.dirname(__file__), "..", "..", "TL_frontend")
app.mount("/static", StaticFiles(directory=frontend_path), name="static")

@app.get("/")
def read_index():
    index_file = os.path.join(frontend_path, "index.html")
    return FileResponse(index_file)

ADMIN_PASSWORD = "admin"  # ‚ö†Ô∏è √Ä mettre dans .env plus tard

@app.get("/admin", response_class=HTMLResponse)
def admin_login_page():
    return """
    <html>
        <body style='font-family: Arial; text-align: center; margin-top: 100px;'>
            <h2>üîí Acc√®s administrateur</h2>
            <form action="/admin" method="post">
                <input type="password" name="password" placeholder="Mot de passe" required />
                <button type="submit">Entrer</button>
            </form>
        </body>
    </html>
    """

@app.post("/admin", response_class=HTMLResponse)
def admin_dashboard(password: str = Form(...)):
    if password != ADMIN_PASSWORD:
        raise HTTPException(status_code=401, detail="Mot de passe incorrect")

    with Session(engine) as session:
        users = session.exec(select(User)).all()

    rows = "".join(
        f"<tr><td>{u.id}</td><td>{u.username}</td><td>{u.email}</td><td>{u.hashed_password}</td></tr>"
        for u in users
    )

    return f"""
    <html>
        <head>
            <style>
                body {{ font-family: Arial; text-align: center; margin-top: 40px; }}
                table {{
                    margin: auto;
                    border-collapse: collapse;
                    width: 80%;
                }}
                th, td {{
                    border: 1px solid #ccc;
                    padding: 8px;
                }}
                th {{
                    background-color: #f2f2f2;
                }}
            </style>
        </head>
        <body>
            <h2>üëë Tableau de bord administrateur</h2>
            <table>
                <tr><th>ID</th><th>Nom</th><th>Email</th><th>Mot de passe hach√©</th></tr>
                {rows or "<tr><td colspan='4'>Aucun utilisateur trouv√©</td></tr>"}
            </table>
            <br>
            <a href="/">Retour √† l'accueil</a>
        </body>
    </html>
    """

# ===== Fichier : /Users/martintarot/Documents/Informatique/TrueLink/TL_backend/app/models.py =====

from typing import Optional
from sqlmodel import SQLModel, Field, Relationship
from pydantic import BaseModel, EmailStr

class User(SQLModel, table=True):
    id: Optional[int] = Field(default=None, primary_key=True)
    username: str
    email: str
    hashed_password: str
    
    # Relation avec Profile
    profile: Optional["Profile"] = Relationship(back_populates="user")

class UserCreate(BaseModel):
    username: str
    email: EmailStr
    password: str

class Profile(SQLModel, table=True):
    id: Optional[int] = Field(default=None, primary_key=True)
    user_id: int = Field(foreign_key="user.id", unique=True)
    
    # Informations de profil
    age: Optional[int] = None
    bio: Optional[str] = None
    city: Optional[str] = None
    photo_url: Optional[str] = None
    gender: Optional[str] = None  # "homme", "femme", "autre"
    looking_for: Optional[str] = None  # "homme", "femme", "tous"
    
    # Flag pour savoir si le profil est compl√©t√©
    is_completed: bool = Field(default=False)
    
    # Relation avec User
    user: Optional[User] = Relationship(back_populates="profile")

class ProfileCreate(BaseModel):
    age: int
    bio: str
    city: str
    photo_url: Optional[str] = None
    gender: str
    looking_for: str

class ProfileUpdate(BaseModel):
    age: Optional[int] = None
    bio: Optional[str] = None
    city: Optional[str] = None
    photo_url: Optional[str] = None
    gender: Optional[str] = None
    looking_for: Optional[str] = None

# ===== Fichier : /Users/martintarot/Documents/Informatique/TrueLink/TL_backend/app/routes/__init__.py =====



# ===== Fichier : /Users/martintarot/Documents/Informatique/TrueLink/TL_backend/app/routes/auth.py =====

from fastapi import APIRouter, Depends, HTTPException, Body
from sqlmodel import Session, select
from ..database import engine
from ..models import User, Profile
from ..core.security import verify_password, create_access_token
from pydantic import BaseModel

router = APIRouter(prefix="/auth", tags=["auth"])

class LoginRequest(BaseModel):
    email: str
    password: str

def get_session():
    with Session(engine) as session:
        yield session

@router.post("/login")
def login(login_data: LoginRequest = Body(...), session: Session = Depends(get_session)):
    user = session.exec(select(User).where(User.email == login_data.email)).first()
    if not user or not verify_password(login_data.password, user.hashed_password):
        raise HTTPException(status_code=401, detail="Invalid email or password")

    # V√©rifier si le profil existe et est compl√©t√©
    profile = session.exec(select(Profile).where(Profile.user_id == user.id)).first()
    profile_completed = profile.is_completed if profile else False

    token = create_access_token({"sub": str(user.id)})
    return {
        "access_token": token, 
        "token_type": "bearer", 
        "username": user.username,
        "user_id": user.id,
        "profile_completed": profile_completed
    }

# ===== Fichier : /Users/martintarot/Documents/Informatique/TrueLink/TL_backend/app/routes/profile.py =====

from fastapi import APIRouter, HTTPException, Depends, Header
from sqlmodel import Session, select
from ..database import engine
from ..models import Profile, ProfileCreate, ProfileUpdate, User
from ..core.security import verify_token
from typing import Optional

router = APIRouter(prefix="/profile", tags=["profile"])

def get_session():
    with Session(engine) as session:
        yield session

def get_current_user_id(authorization: Optional[str] = Header(None)) -> int:
    """Extrait l'user_id depuis le token JWT dans le header Authorization"""
    if not authorization or not authorization.startswith("Bearer "):
        raise HTTPException(status_code=401, detail="Token manquant ou invalide")
    
    token = authorization.replace("Bearer ", "")
    user_id = verify_token(token)
    if not user_id:
        raise HTTPException(status_code=401, detail="Token invalide ou expir√©")
    
    return user_id

@router.get("/me")
def get_my_profile(
    user_id: int = Depends(get_current_user_id),
    session: Session = Depends(get_session)
):
    """R√©cup√®re le profil de l'utilisateur connect√©"""
    profile = session.exec(
        select(Profile).where(Profile.user_id == user_id)
    ).first()
    
    if not profile:
        return {"profile_exists": False, "message": "Profil non cr√©√©"}
    
    return {
        "profile_exists": True,
        "profile": profile
    }

@router.post("/create")
def create_profile(
    profile_data: ProfileCreate,
    user_id: int = Depends(get_current_user_id),
    session: Session = Depends(get_session)
):
    """Cr√©e le profil de l'utilisateur (premi√®re connexion)"""
    # V√©rifier si le profil existe d√©j√†
    existing_profile = session.exec(
        select(Profile).where(Profile.user_id == user_id)
    ).first()
    
    if existing_profile:
        raise HTTPException(status_code=400, detail="Profil d√©j√† existant")
    
    # Cr√©er le profil
    new_profile = Profile(
        user_id=user_id,
        age=profile_data.age,
        bio=profile_data.bio,
        city=profile_data.city,
        photo_url=profile_data.photo_url,
        gender=profile_data.gender,
        looking_for=profile_data.looking_for,
        is_completed=True
    )
    
    session.add(new_profile)
    session.commit()
    session.refresh(new_profile)
    
    return {"message": "Profil cr√©√© avec succ√®s", "profile": new_profile}

@router.put("/update")
def update_profile(
    profile_data: ProfileUpdate,
    user_id: int = Depends(get_current_user_id),
    session: Session = Depends(get_session)
):
    """Met √† jour le profil de l'utilisateur"""
    profile = session.exec(
        select(Profile).where(Profile.user_id == user_id)
    ).first()
    
    if not profile:
        raise HTTPException(status_code=404, detail="Profil non trouv√©")
    
    # Mise √† jour des champs fournis
    update_data = profile_data.model_dump(exclude_unset=True)
    for key, value in update_data.items():
        setattr(profile, key, value)
    
    # Marquer comme compl√©t√© si au moins les champs de base sont remplis
    if profile.age and profile.bio and profile.city and profile.gender and profile.looking_for:
        profile.is_completed = True
    
    session.add(profile)
    session.commit()
    session.refresh(profile)
    
    return {"message": "Profil mis √† jour avec succ√®s", "profile": profile}

@router.get("/{user_id}")
def get_user_profile(
    user_id: int,
    current_user_id: int = Depends(get_current_user_id),
    session: Session = Depends(get_session)
):
    """R√©cup√®re le profil d'un autre utilisateur (pour le matching plus tard)"""
    profile = session.exec(
        select(Profile).where(Profile.user_id == user_id)
    ).first()
    
    if not profile:
        raise HTTPException(status_code=404, detail="Profil non trouv√©")
    
    if not profile.is_completed:
        raise HTTPException(status_code=403, detail="Profil non compl√©t√©")
    
    # R√©cup√©rer aussi le username
    user = session.exec(select(User).where(User.id == user_id)).first()
    
    return {
        "username": user.username if user else None,
        "profile": profile
    }

# ===== Fichier : /Users/martintarot/Documents/Informatique/TrueLink/TL_backend/app/routes/users.py =====

from fastapi import APIRouter, HTTPException, Depends
from sqlmodel import Session
from ..database import engine
from ..models import User, UserCreate
from ..core.security import hash_password
from sqlmodel import select

router = APIRouter(prefix="/users", tags=["users"])

def get_session():
    with Session(engine) as session:
        yield session

@router.post("/register")
def register(user_data: UserCreate, session: Session = Depends(get_session)):
    statement = select(User).where(User.email == user_data.email)
    existing_user = session.exec(statement).first()
    if existing_user:
        raise HTTPException(status_code=400, detail="Email already registered")
    print("\nLe mot de passe ressemble a ca :",user_data.password)
    print("\nle type du mdp est :",type(user_data.password))
    hashed_pw = hash_password(user_data.password)
    new_user = User(username=user_data.username, email=user_data.email, hashed_password=hashed_pw)
    session.add(new_user)
    session.commit()
    session.refresh(new_user)

    return {"message": "User created successfully", "user_id": new_user.id}


# ===== Fichier : /Users/martintarot/Documents/Informatique/TrueLink/TL_frontend/index.html =====

<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TrueLink - Bienvenue</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .container {
      text-align: center;
      max-width: 500px;
    }

    .logo {
      font-size: 80px;
      margin-bottom: 20px;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    h1 {
      color: white;
      font-size: 42px;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
    }

    .subtitle {
      color: rgba(255,255,255,0.9);
      font-size: 18px;
      margin-bottom: 40px;
    }

    .buttons {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-bottom: 30px;
    }

    .btn {
      display: inline-block;
      background: white;
      color: #667eea;
      padding: 16px 40px;
      border-radius: 30px;
      text-decoration: none;
      font-weight: 600;
      font-size: 16px;
      transition: all 0.3s;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }

    .btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.3);
    }

    .btn.secondary {
      background: transparent;
      color: white;
      border: 2px solid white;
    }

    .features {
      display: flex;
      justify-content: space-around;
      margin-top: 50px;
      gap: 20px;
    }

    .feature {
      color: white;
      font-size: 14px;
    }

    .feature-icon {
      font-size: 30px;
      margin-bottom: 8px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="logo">üíï</div>
    <h1>TrueLink</h1>
    <p class="subtitle">Trouvez votre √¢me s≈ìur en toute simplicit√©</p>
    
    <div class="buttons">
      <a href="/static/register.html" class="btn">Cr√©er un compte</a>
      <a href="/static/login.html" class="btn secondary">Se connecter</a>
    </div>

    <div class="features">
      <div class="feature">
        <div class="feature-icon">üîí</div>
        <div>S√©curis√©</div>
      </div>
      <div class="feature">
        <div class="feature-icon">‚ö°</div>
        <div>Rapide</div>
      </div>
      <div class="feature">
        <div class="feature-icon">üí¨</div>
        <div>Simple</div>
      </div>
    </div>
  </div>

  <script>
    // Rediriger si d√©j√† connect√©
    if (localStorage.getItem('token')) {
      window.location.href = '/static/profile.html';
    }
  </script>
</body>
</html>

# ===== Fichier : /Users/martintarot/Documents/Informatique/TrueLink/TL_frontend/login.html =====

<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Connexion - TrueLink</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .container {
      width: 100%;
      max-width: 400px;
    }

    .form-card {
      background: white;
      padding: 40px;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }

    .logo {
      text-align: center;
      font-size: 60px;
      margin-bottom: 20px;
    }

    h2 {
      text-align: center;
      color: #667eea;
      margin-bottom: 30px;
      font-size: 28px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      color: #333;
      font-weight: 600;
      margin-bottom: 8px;
      font-size: 14px;
    }

    input {
      width: 100%;
      padding: 12px;
      border: 2px solid #e1e8ed;
      border-radius: 8px;
      font-size: 14px;
      transition: border-color 0.3s;
    }

    input:focus {
      outline: none;
      border-color: #667eea;
    }

    button {
      width: 100%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 14px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      margin-top: 10px;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }

    button:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }

    .message {
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 20px;
      font-size: 14px;
      display: none;
    }

    .message.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .message.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    .link-container {
      text-align: center;
      margin-top: 20px;
      color: #666;
      font-size: 14px;
    }

    .link-container a {
      color: #667eea;
      text-decoration: none;
      font-weight: 600;
    }

    .link-container a:hover {
      text-decoration: underline;
    }

    .back-link {
      text-align: center;
      margin-top: 15px;
    }

    .back-link a {
      color: #999;
      text-decoration: none;
      font-size: 13px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="form-card">
      <div class="logo">üíï</div>
      <h2>Connexion</h2>
      
      <div id="loginMessage" class="message"></div>

      <form id="loginForm">
        <div class="form-group">
          <label for="loginEmail">Email</label>
          <input type="email" id="loginEmail" placeholder="votre@email.com" required>
        </div>

        <div class="form-group">
          <label for="loginPassword">Mot de passe</label>
          <input type="password" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
        </div>

        <button type="submit" id="submitBtn">Se connecter</button>
      </form>

      <div class="link-container">
        Pas encore de compte ? <a href="/static/register.html">S'inscrire</a>
      </div>

      <div class="back-link">
        <a href="/">‚Üê Retour √† l'accueil</a>
      </div>
    </div>
  </div>

  <script>
    const loginForm = document.getElementById("loginForm");
    const messageDiv = document.getElementById("loginMessage");
    const submitBtn = document.getElementById("submitBtn");

    loginForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      
      submitBtn.disabled = true;
      submitBtn.textContent = "Connexion en cours...";

      const email = document.getElementById("loginEmail").value;
      const password = document.getElementById("loginPassword").value;

      try {
        const res = await fetch("/auth/login", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email, password })
        });

        const data = await res.json();

        if (res.ok) {
          localStorage.setItem("token", data.access_token);
          messageDiv.textContent = `‚úÖ Bienvenue ${data.username} !`;
          messageDiv.className = "message success";
          messageDiv.style.display = "block";

          setTimeout(() => {
            window.location.href = "/static/profile.html";
          }, 1000);
        } else {
          messageDiv.textContent = `‚ùå ${data.detail}`;
          messageDiv.className = "message error";
          messageDiv.style.display = "block";
          submitBtn.disabled = false;
          submitBtn.textContent = "Se connecter";
        }
      } catch (error) {
        messageDiv.textContent = "‚ùå Erreur de connexion au serveur";
        messageDiv.className = "message error";
        messageDiv.style.display = "block";
        submitBtn.disabled = false;
        submitBtn.textContent = "Se connecter";
      }
    });
  </script>
</body>
</html>

# ===== Fichier : /Users/martintarot/Documents/Informatique/TrueLink/TL_frontend/profile.html =====

<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mon Profil - TrueLink</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 600px;
      margin: 0 auto;
    }
    
    .header {
      background: white;
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 20px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .header h1 {
      font-size: 24px;
      color: #667eea;
    }
    
    .logout-btn {
      background: #ff4757;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      transition: background 0.3s;
    }
    
    .logout-btn:hover {
      background: #ff3838;
    }
    
    .profile-card {
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    
    .profile-form {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }
    
    .form-group {
      display: flex;
      flex-direction: column;
    }
    
    label {
      font-weight: 600;
      margin-bottom: 8px;
      color: #333;
      font-size: 14px;
    }
    
    input, textarea, select {
      padding: 12px;
      border: 2px solid #e1e8ed;
      border-radius: 8px;
      font-size: 14px;
      transition: border-color 0.3s;
      font-family: inherit;
    }
    
    input:focus, textarea:focus, select:focus {
      outline: none;
      border-color: #667eea;
    }
    
    textarea {
      resize: vertical;
      min-height: 100px;
    }
    
    .btn-group {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }
    
    button[type="submit"] {
      flex: 1;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 14px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    
    button[type="submit"]:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(102, 126, 234, 0.4);
    }
    
    .message {
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 20px;
      font-size: 14px;
      font-weight: 500;
    }
    
    .message.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    
    .message.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    
    .loading {
      text-align: center;
      padding: 40px;
      color: #666;
    }
    
    .profile-view {
      display: none;
    }
    
    .profile-view.active {
      display: block;
    }
    
    .info-row {
      display: flex;
      justify-content: space-between;
      padding: 15px 0;
      border-bottom: 1px solid #e1e8ed;
    }
    
    .info-row:last-child {
      border-bottom: none;
    }
    
    .info-label {
      font-weight: 600;
      color: #666;
    }
    
    .info-value {
      color: #333;
      text-align: right;
      max-width: 60%;
    }
    
    .edit-btn {
      background: #667eea;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      margin-top: 20px;
      width: 100%;
      transition: background 0.3s;
    }
    
    .edit-btn:hover {
      background: #5568d3;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üíï TrueLink</h1>
      <button class="logout-btn" onclick="logout()">D√©connexion</button>
    </div>

    <div class="profile-card">
      <div id="loading" class="loading">
        Chargement de votre profil...
      </div>

      <div id="message"></div>

      <div id="profileView" class="profile-view">
        <h2 style="margin-bottom: 20px; color: #667eea;">Mon Profil</h2>
        <div id="profileData"></div>
        <button class="edit-btn" onclick="toggleEdit()">Modifier mon profil</button>
      </div>

      <form id="profileForm" class="profile-form" style="display: none;">
        <h2 style="color: #667eea;" id="formTitle">Cr√©er mon profil</h2>
        
        <div class="form-group">
          <label for="age">√Çge</label>
          <input type="number" id="age" min="18" max="100" required>
        </div>

        <div class="form-group">
          <label for="gender">Genre</label>
          <select id="gender" required>
            <option value="">-- S√©lectionner --</option>
            <option value="homme">Homme</option>
            <option value="femme">Femme</option>
            <option value="autre">Autre</option>
          </select>
        </div>

        <div class="form-group">
          <label for="looking_for">Je recherche</label>
          <select id="looking_for" required>
            <option value="">-- S√©lectionner --</option>
            <option value="homme">Des hommes</option>
            <option value="femme">Des femmes</option>
            <option value="tous">Peu importe</option>
          </select>
        </div>

        <div class="form-group">
          <label for="city">Ville</label>
          <input type="text" id="city" placeholder="Paris" required>
        </div>

        <div class="form-group">
          <label for="bio">Biographie</label>
          <textarea id="bio" placeholder="Parlez-nous de vous..." required></textarea>
        </div>

        <div class="form-group">
          <label for="photo_url">URL de la photo (optionnel)</label>
          <input type="url" id="photo_url" placeholder="https://exemple.com/photo.jpg">
        </div>

        <div class="btn-group">
          <button type="submit">Enregistrer</button>
        </div>
      </form>
    </div>
  </div>

  <script src="/static/profile.js"></script>
</body>
</html>

# ===== Fichier : /Users/martintarot/Documents/Informatique/TrueLink/TL_frontend/profile.js =====

let currentProfile = null;
let isEditing = false;

document.addEventListener("DOMContentLoaded", async () => {
  const token = localStorage.getItem("token");
  if (!token) {
    window.location.href = "/static/login.html";
    return;
  }

  await loadProfile();

  document.getElementById("profileForm").addEventListener("submit", async (e) => {
    e.preventDefault();
    await saveProfile();
  });
});

async function loadProfile() {
  const token = localStorage.getItem("token");
  const loading = document.getElementById("loading");

  try {
    const res = await fetch("/profile/me", {
      headers: { "Authorization": `Bearer ${token}` }
    });

    if (res.status === 401) {
      localStorage.removeItem("token");
      window.location.href = "/static/login.html";
      return;
    }

    const data = await res.json();

    loading.style.display = "none";

    if (data.profile_exists) {
      currentProfile = data.profile;
      showProfileView();
    } else {
      document.getElementById("profileForm").style.display = "flex";
      document.getElementById("formTitle").textContent = "Cr√©er mon profil";
    }
  } catch (error) {
    loading.style.display = "none";
    showMessage("Erreur lors du chargement du profil", "error");
  }
}

function showProfileView() {
  const profileView = document.getElementById("profileView");
  const profileData = document.getElementById("profileData");
  
  const genderLabels = {
    "homme": "Homme",
    "femme": "Femme",
    "autre": "Autre"
  };
  
  const lookingForLabels = {
    "homme": "Des hommes",
    "femme": "Des femmes",
    "tous": "Peu importe"
  };

  profileData.innerHTML = `
    <div class="info-row">
      <span class="info-label">√Çge</span>
      <span class="info-value">${currentProfile.age} ans</span>
    </div>
    <div class="info-row">
      <span class="info-label">Genre</span>
      <span class="info-value">${genderLabels[currentProfile.gender] || currentProfile.gender}</span>
    </div>
    <div class="info-row">
      <span class="info-label">Recherche</span>
      <span class="info-value">${lookingForLabels[currentProfile.looking_for] || currentProfile.looking_for}</span>
    </div>
    <div class="info-row">
      <span class="info-label">Ville</span>
      <span class="info-value">${currentProfile.city}</span>
    </div>
    <div class="info-row">
      <span class="info-label">Biographie</span>
      <span class="info-value">${currentProfile.bio}</span>
    </div>
    ${currentProfile.photo_url ? `
    <div class="info-row">
      <span class="info-label">Photo</span>
      <span class="info-value"><a href="${currentProfile.photo_url}" target="_blank" style="color: #667eea;">Voir la photo</a></span>
    </div>
    ` : ''}
  `;

  profileView.classList.add("active");
  document.getElementById("profileForm").style.display = "none";
}

function toggleEdit() {
  const profileView = document.getElementById("profileView");
  const profileForm = document.getElementById("profileForm");
  const formTitle = document.getElementById("formTitle");

  profileView.classList.remove("active");
  profileForm.style.display = "flex";
  formTitle.textContent = "Modifier mon profil";
  isEditing = true;

  document.getElementById("age").value = currentProfile.age;
  document.getElementById("gender").value = currentProfile.gender;
  document.getElementById("looking_for").value = currentProfile.looking_for;
  document.getElementById("city").value = currentProfile.city;
  document.getElementById("bio").value = currentProfile.bio;
  document.getElementById("photo_url").value = currentProfile.photo_url || "";
}

async function saveProfile() {
  const token = localStorage.getItem("token");
  const messageDiv = document.getElementById("message");

  const profileData = {
    age: parseInt(document.getElementById("age").value),
    gender: document.getElementById("gender").value,
    looking_for: document.getElementById("looking_for").value,
    city: document.getElementById("city").value,
    bio: document.getElementById("bio").value,
    photo_url: document.getElementById("photo_url").value || null
  };

  try {
    const endpoint = isEditing ? "/profile/update" : "/profile/create";
    const method = isEditing ? "PUT" : "POST";

    const res = await fetch(endpoint, {
      method: method,
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${token}`
      },
      body: JSON.stringify(profileData)
    });

    const data = await res.json();

    if (res.ok) {
      showMessage(data.message, "success");
      currentProfile = data.profile;
      isEditing = false;
      setTimeout(() => {
        showProfileView();
        messageDiv.innerHTML = "";
      }, 1500);
    } else {
      showMessage(`Erreur : ${data.detail}`, "error");
    }
  } catch (error) {
    showMessage("Erreur lors de l'enregistrement", "error");
  }
}

function showMessage(text, type) {
  const messageDiv = document.getElementById("message");
  messageDiv.textContent = text;
  messageDiv.className = `message ${type}`;
  messageDiv.style.display = "block";
}

function logout() {
  localStorage.removeItem("token");
  window.location.href = "/";
}

# ===== Fichier : /Users/martintarot/Documents/Informatique/TrueLink/TL_frontend/register.html =====

<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Inscription - TrueLink</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .container {
      width: 100%;
      max-width: 400px;
    }

    .form-card {
      background: white;
      padding: 40px;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }

    .logo {
      text-align: center;
      font-size: 60px;
      margin-bottom: 20px;
    }

    h2 {
      text-align: center;
      color: #667eea;
      margin-bottom: 30px;
      font-size: 28px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      color: #333;
      font-weight: 600;
      margin-bottom: 8px;
      font-size: 14px;
    }

    input {
      width: 100%;
      padding: 12px;
      border: 2px solid #e1e8ed;
      border-radius: 8px;
      font-size: 14px;
      transition: border-color 0.3s;
    }

    input:focus {
      outline: none;
      border-color: #667eea;
    }

    button {
      width: 100%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 14px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      margin-top: 10px;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }

    button:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }

    .message {
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 20px;
      font-size: 14px;
      display: none;
    }

    .message.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .message.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    .link-container {
      text-align: center;
      margin-top: 20px;
      color: #666;
      font-size: 14px;
    }

    .link-container a {
      color: #667eea;
      text-decoration: none;
      font-weight: 600;
    }

    .link-container a:hover {
      text-decoration: underline;
    }

    .back-link {
      text-align: center;
      margin-top: 15px;
    }

    .back-link a {
      color: #999;
      text-decoration: none;
      font-size: 13px;
    }

    .password-strength {
      font-size: 12px;
      margin-top: 5px;
      color: #666;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="form-card">
      <div class="logo">üíï</div>
      <h2>Cr√©er un compte</h2>
      
      <div id="message" class="message"></div>

      <form id="registerForm">
        <div class="form-group">
          <label for="username">Nom d'utilisateur</label>
          <input type="text" id="username" placeholder="Alice" required>
        </div>

        <div class="form-group">
          <label for="email">Email</label>
          <input type="email" id="email" placeholder="votre@email.com" required>
        </div>

        <div class="form-group">
          <label for="password">Mot de passe</label>
          <input type="password" id="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required minlength="6">
          <div class="password-strength">Minimum 6 caract√®res</div>
        </div>

        <button type="submit" id="submitBtn">S'inscrire</button>
      </form>

      <div class="link-container">
        D√©j√† un compte ? <a href="/static/login.html">Se connecter</a>
      </div>

      <div class="back-link">
        <a href="/">‚Üê Retour √† l'accueil</a>
      </div>
    </div>
  </div>

  <script>
    const registerForm = document.getElementById("registerForm");
    const messageDiv = document.getElementById("message");
    const submitBtn = document.getElementById("submitBtn");

    registerForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      
      submitBtn.disabled = true;
      submitBtn.textContent = "Cr√©ation en cours...";

      const data = {
        username: document.getElementById("username").value,
        email: document.getElementById("email").value,
        password: document.getElementById("password").value,
      };

      try {
        const res = await fetch("/users/register", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data),
        });

        const result = await res.json();

        if (res.ok) {
          messageDiv.textContent = `‚úÖ Compte cr√©√© avec succ√®s !`;
          messageDiv.className = "message success";
          messageDiv.style.display = "block";
          
          registerForm.reset();
          
          setTimeout(() => {
            window.location.href = "/static/login.html";
          }, 1500);
        } else {
          messageDiv.textContent = `‚ùå ${result.detail}`;
          messageDiv.className = "message error";
          messageDiv.style.display = "block";
          submitBtn.disabled = false;
          submitBtn.textContent = "S'inscrire";
        }
      } catch (error) {
        messageDiv.textContent = "‚ùå Erreur de connexion au serveur";
        messageDiv.className = "message error";
        messageDiv.style.display = "block";
        submitBtn.disabled = false;
        submitBtn.textContent = "S'inscrire";
      }
    });
  </script>
</body>
</html>

# ===== Fichier : /Users/martintarot/Documents/Informatique/TrueLink/merge_py_files.py =====

import os

# --- Param√®tres ---
OUTPUT_FILE = "all_text_files_merged.txt"
INCLUDE_SUBFOLDERS = True  # Mets False si tu veux ignorer les sous-dossiers
INCLUDED_EXTENSIONS = {".py", ".txt", ".md", ".html", ".js"}


def is_hidden(path):
    """Retourne True si le fichier ou dossier est cach√© (commence par un point)."""
    return any(part.startswith('.') for part in path.split(os.sep))


def collect_text_files(root_path, include_subfolders=True):
    text_files = []
    for root, dirs, files in os.walk(root_path):
        # On ignore les dossiers cach√©s
        dirs[:] = [d for d in dirs if not d.startswith('.')]
        for file in files:
            if file.startswith('.'):
                continue  # Ignore fichiers cach√©s (.gitignore, etc.)
            ext = os.path.splitext(file)[1].lower()
            if ext in INCLUDED_EXTENSIONS:
                full_path = os.path.join(root, file)
                if not is_hidden(full_path):
                    text_files.append(full_path)
        if not include_subfolders:
            break
    return text_files


def merge_files(file_list, output_path):
    with open(output_path, "w", encoding="utf-8") as outfile:
        for path in sorted(file_list):
            outfile.write(f"\n\n# ===== Fichier : {path} =====\n\n")
            try:
                with open(path, "r", encoding="utf-8") as infile:
                    outfile.write(infile.read())
            except Exception as e:
                outfile.write(f"[Erreur de lecture : {e}]\n")


if __name__ == "__main__":
    current_dir = os.path.dirname(os.path.abspath(__file__))
    output_path = os.path.join(current_dir, OUTPUT_FILE)

    all_files = collect_text_files(current_dir, INCLUDE_SUBFOLDERS)

    # On √©vite d'inclure le fichier de sortie lui-m√™me
    all_files = [f for f in all_files if os.path.abspath(f) != os.path.abspath(output_path)]

    merge_files(all_files, output_path)
    print(f"‚úÖ Fusion termin√©e ({len(all_files)} fichiers) ‚Üí {OUTPUT_FILE}")


# ===== Fichier : /Users/martintarot/Documents/Informatique/TrueLink/requirements.txt =====

annotated-types==0.7.0
anyio==4.11.0
appnope==0.1.4
asttokens==3.0.0
bcrypt==5.0.0
click==8.3.0
comm==0.2.3
debugpy==1.8.17
decorator==5.2.1
dnspython==2.8.0
email-validator==2.3.0
executing==2.2.1
fastapi==0.119.0
h11==0.16.0
idna==3.11
ipykernel==7.0.1
ipython==9.6.0
ipython_pygments_lexers==1.1.1
jedi==0.19.2
jupyter_client==8.6.3
jupyter_core==5.9.1
matplotlib-inline==0.1.7
nest-asyncio==1.6.0
packaging==25.0
parso==0.8.5
passlib==1.7.4
pexpect==4.9.0
platformdirs==4.5.0
prompt_toolkit==3.0.52
psutil==7.1.1
ptyprocess==0.7.0
pure_eval==0.2.3
pydantic==2.12.3
pydantic_core==2.41.4
Pygments==2.19.2
python-dateutil==2.9.0.post0
pyzmq==27.1.0
six==1.17.0
sniffio==1.3.1
SQLAlchemy==2.0.44
sqlmodel==0.0.27
stack-data==0.6.3
starlette==0.48.0
tornado==6.5.2
traitlets==5.14.3
typing==3.7.4.3
typing-inspection==0.4.2
typing_extensions==4.15.0
uvicorn==0.38.0
wcwidth==0.2.14
